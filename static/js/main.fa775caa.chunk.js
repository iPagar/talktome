(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{105:function(e,t,n){e.exports=n.p+"static/media/send.5d4960d5.svg"},166:function(e,t,n){e.exports=n(257)},249:function(e,t,n){},257:function(e,t,n){"use strict";n.r(t);n(167),n(217);var a=n(0),c=n.n(a),r=n(37),i=n.n(r),o=n(42),s=n(68),l=n(27),u=n(28),d=n(35),h=n(34),p=n(36),m=n(16),f=(n(248),n(249),n(106)),b=n.n(f),g=n(105),v=n.n(g),y=function(e){var t=e.myId,n=e.data,a=(n.id,n.sender_id),r=(n.reciever_id,n.unixtime,n.text);return c.a.createElement("div",{style:{display:"flex",width:"100%"}},c.a.createElement("div",{className:"Message",style:a===t?{marginLeft:"auto",backgroundColor:"#cfe6ff",color:"black"}:null},r))},E=n(107),k=function(){function e(){Object(l.a)(this,e)}return Object(u.a)(e,null,[{key:"send",value:function(e,t){return fetch("https://ipagar.ddns.net:8082"+e,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(Object(E.a)({},t,{sign:window.location.search.slice(1)}))}).then(function(e){if(200===e.status)return e.json();throw new Error(e.status)})}}]),e}(),I=null,j=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(d.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).state={messages:[],writeng:""},n.sendButton=c.a.createRef(),n.updateMessages=function(){var e=n.props.userId;return k.send("/messages",{reciever_id:e}).then(function(e){n.setState({messages:e})})},n.onClick=function(e){var t=n.state.writeng,a=n.props.userId;k.send("/message",{reciever_id:a,text:t}).then(function(e){n.updateMessages().then(function(){window.scrollTo(0,document.body.scrollHeight),n.setState({writeng:""})})})},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.updateMessages().then(function(){setTimeout(function(){window.scrollTo(0,document.body.scrollHeight)},1e3)}),I=setInterval(this.updateMessages,1e3)}},{key:"componentWillUnmount",value:function(){clearTimeout(I)}},{key:"render",value:function(){var e=this,t=this.state,n=t.writeng,a=t.messages,r=this.props,i=r.myId,o=r.back,s=r.pavId;return c.a.createElement(m.f,{id:"chat",centered:!(a.length>0)},c.a.createElement(m.g,{left:i===s?c.a.createElement(b.a,{onClick:function(){o()}}):null},"\u0412 \u0447\u0430\u0442\u0438\u043a\u0435"),a.length>0?c.a.createElement("div",{style:{paddingBottom:60}},a.map(function(e){return c.a.createElement(y,{key:e.id,data:e,myId:i})})):c.a.createElement(c.a.Fragment,null,c.a.createElement(m.c,{style:{distextAlign:"center",bottom:0,textAlign:"center"}},c.a.createElement("h1",null,c.a.createElement("b",null,"\u042d\u0442\u043e \u0430\u043d\u043e\u043d\u0438\u043c\u043d\u043e")),c.a.createElement("br",null),"\u041f\u0430\u0432\u0435\u043b \u043d\u0435 \u0443\u0437\u043d\u0430\u0435\u0442, \u043a\u0442\u043e \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0435\u0433\u043e \u0441\u043e\u0431\u0435\u0441\u0435\u0434\u043d\u0438\u043a\u043e\u043c."),c.a.createElement(m.c,{style:{position:"absolute",bottom:0,left:0,right:0}})),c.a.createElement(m.d,{vertical:"bottom"},c.a.createElement("div",{style:{padding:5,display:"flex",placeItems:"center"}},c.a.createElement("div",{id:"background",style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"#f5f5f5",zIndex:-1}}),c.a.createElement("input",{ref:this.sendButton,style:{flex:1,background:"var(--background_light)"},autocomplete:"off",type:"text",name:"writeng",placeholder:"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435...",value:n,onChange:function(t){e.setState({writeng:t.currentTarget.value})}}),c.a.createElement("img",{onClick:this.onClick,src:v.a,style:{height:"44px",align:"center"}}))))}}]),t}(c.a.Component),w=null,O=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,c=new Array(a),r=0;r<a;r++)c[r]=arguments[r];return(n=Object(d.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(c)))).state={chats:[]},n.updateChats=function(){k.send("/chats").then(function(e){n.setState({chats:e})})},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this.props;e.myId,e.pavId,e.openChat;this.updateChats(),w=setInterval(this.updateChats,1e4)}},{key:"componentWillUnmount",value:function(){clearTimeout(w)}},{key:"render",value:function(){var e=this.state.chats,t=this.props,n=t.myId,a=t.pavId,r=this.props.openChat;return c.a.createElement(m.f,{id:"home",centered:n!==a},c.a.createElement(m.g,null,n===a?"\u0427\u0430\u0442\u0438\u043a\u0438":"\u0417\u0434\u0440\u0430\u0432\u0441\u0442\u0432\u0443\u0439\u0442\u0435!"),e.length>0?c.a.createElement(m.e,null,e.map(function(e,t){return c.a.createElement(m.a,{expandable:!0,onClick:function(){r(e.user_id)}},"\u0421\u043e\u0431\u0435\u0441\u0435\u0434\u043d\u0438\u043a #",t+1)})):c.a.createElement(m.c,{style:{textAlign:"center"}},"\u041f\u043e\u043a\u0430 \u043d\u0438\u043a\u0442\u043e \u043d\u0435 \u043d\u0430\u043f\u0438\u0441\u0430\u043b :("))}}]),t}(c.a.Component),C=function(e){function t(){return Object(l.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return c.a.createElement(m.f,{id:"loadingPanel",centered:!0},c.a.createElement(m.g,null,"\u0417\u0430\u0433\u0440\u0443\u0437\u043e\u0447\u043a\u0430..."),c.a.createElement(m.h,null))}}]),t}(c.a.Component),x=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,c=new Array(a),r=0;r<a;r++)c[r]=arguments[r];return(n=Object(d.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(c)))).state={history:[],activePanel:"loadingPanel",userId:null,myId:null,pavId:67602787},n.openChat=function(e){n.setState({userId:e}),n.go("chat")},n.go=function(e){var t=Object(s.a)(n.state.history);t.push(e),"home"===n.state.activePanel&&o.a.send("VKWebAppEnableSwipeBack"),n.setState({history:t,activePanel:e})},n.back=function(){console.log(n.state.history);var e=Object(s.a)(n.state.history);e.pop();var t=e[e.length-1];"home"===t&&o.a.send("VKWebAppDisableSwipeBack"),n.setState({history:e,activePanel:t})},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"setTheme",value:function(){var e=document.createAttribute("scheme");e.value="bright_light",document.body.attributes.setNamedItem(e)}},{key:"componentDidMount",value:function(){var e=this,t=this.state,n=(t.myId,t.pavId);t.openChat;this.setTheme(),o.a.send("VKWebAppGetUserInfo",{}).then(function(t){e.setState({myId:t.data.id}),t.data.id===n?e.go("home"):e.openChat(n)})}},{key:"render",value:function(){var e=this.state,t=e.myId,n=e.pavId,a=e.userId;return c.a.createElement(m.b,{isWebView:!0},c.a.createElement(m.i,{onSwipeBack:this.back,history:this.state.history,activePanel:this.state.activePanel},c.a.createElement(C,{id:"loadingPanel"}),c.a.createElement(O,{id:"home",myId:t,pavId:n,openChat:this.openChat}),c.a.createElement(j,{id:"chat",myId:t,pavId:n,back:this.back,userId:a})))}}]),t}(c.a.Component);o.a.send("VKWebAppInit",{}),i.a.render(c.a.createElement(x,null),document.getElementById("root"))}},[[166,1,2]]]);
//# sourceMappingURL=main.fa775caa.chunk.js.map