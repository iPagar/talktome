(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{105:function(e,t,n){e.exports=n.p+"static/media/send.5d4960d5.svg"},166:function(e,t,n){e.exports=n(257)},249:function(e,t,n){},257:function(e,t,n){"use strict";n.r(t);n(167),n(217);var a=n(0),s=n.n(a),i=n(37),r=n.n(i),c=n(42),o=n(68),l=n(27),u=n(28),d=n(35),h=n(34),p=n(36),m=n(16),f=(n(248),n(249),n(106)),g=n.n(f),v=n(105),b=n.n(v),y=function(e){var t=e.myId,n=e.data,a=(n.id,n.sender_id),i=(n.reciever_id,n.unixtime,n.text);return s.a.createElement("div",{style:{display:"flex",width:"100%"}},s.a.createElement("div",{className:"Message",style:a===t?{marginLeft:"auto",backgroundColor:"#cfe6ff",color:"black"}:null},i))},E=n(107),I=function(){function e(){Object(l.a)(this,e)}return Object(u.a)(e,null,[{key:"send",value:function(e,t){return fetch("https://ipagar.ddns.net:8082"+e,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(Object(E.a)({},t,{sign:window.location.search.slice(1)}))}).then(function(e){if(200===e.status)return e.json();throw new Error(e.status)})}}]),e}(),k=null,C=[],j=null,w=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(d.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(i)))).state={messages:[],isLoading:!0,writeng:""},n.sendButton=s.a.createRef(),n.mesContentRef=s.a.createRef(),n.updateScroll=function(){window.scrollTo(0,n.mesContentRef.current.scrollHeight)},n.updateMessages=function(){var e=n.props.userId;return I.send("/messages",{reciever_id:e}).then(function(e){n.setState({messages:e,isLoading:!1})})},n.onClick=function(e){var t=n.state.writeng,a=n.props.userId;I.send("/message",{reciever_id:a,text:t}).then(function(e){n.updateMessages().then(function(){n.setState({writeng:""})})})},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.userId;j===t&&this.setState({messages:C}),this.updateMessages().then(function(){setTimeout(e.updateScroll,1e3)}),k=setInterval(this.updateMessages,1e3)}},{key:"componentWillUnmount",value:function(){var e=this.state.messages,t=this.props.userId;e.length>0&&(C=e,j=t),clearTimeout(k)}},{key:"render",value:function(){var e=this;console.log(window.innerHeight,this.mesContentRef.current?this.mesContentRef.current.clientHeight:null);var t=this.state,n=t.writeng,a=t.messages,i=t.isLoading,r=this.props,c=r.myId,o=r.back,l=r.pavId;return s.a.createElement(m.f,{id:"chat",centered:!(a.length>0||!i)},s.a.createElement(m.g,{left:c===l?s.a.createElement(g.a,{onClick:function(){o()}}):null},i?"\u0417\u0430\u0433\u0440\u0443\u0437\u043e\u0447\u043a\u0430...":"\u0412 \u0447\u0430\u0442\u0438\u043a\u0435"),a.length>0||!i?s.a.createElement("div",{className:"MessagesContent",ref:this.mesContentRef},a.map(function(e){return s.a.createElement(y,{key:e.id,data:e,myId:c})})):s.a.createElement(s.a.Fragment,null,s.a.createElement(m.c,{style:{distextAlign:"center",bottom:0,textAlign:"center"}},s.a.createElement("h1",null,s.a.createElement("b",null,"\u042d\u0442\u043e \u0430\u043d\u043e\u043d\u0438\u043c\u043d\u043e")),s.a.createElement("br",null),"\u041f\u0430\u0432\u0435\u043b \u043d\u0435 \u0443\u0437\u043d\u0430\u0435\u0442, \u043a\u0442\u043e \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0435\u0433\u043e \u0441\u043e\u0431\u0435\u0441\u0435\u0434\u043d\u0438\u043a\u043e\u043c."),s.a.createElement(m.c,{style:{position:"absolute",bottom:0,left:0,right:0}})),s.a.createElement(m.d,{vertical:"bottom"},s.a.createElement("div",{style:{padding:5,display:"flex",placeItems:"center"}},s.a.createElement("div",{id:"background",style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"#f5f5f5",zIndex:-1}}),s.a.createElement("input",{ref:this.sendButton,style:{flex:1,background:"var(--background_light)"},autocomplete:"off",type:"text",name:"writeng",placeholder:"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435...",value:n,onChange:function(t){e.setState({writeng:t.currentTarget.value})}}),s.a.createElement("img",{onClick:this.onClick,src:b.a,style:{height:"44px",align:"center"}}))))}}]),t}(s.a.Component),O=null,S=[],x=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];return(n=Object(d.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(s)))).state={chats:[]},n.updateChats=function(){I.send("/chats").then(function(e){n.setState({chats:e})})},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this.props;e.myId,e.pavId,e.openChat;this.setState({chats:S}),this.updateChats(),O=setInterval(this.updateChats,1e4)}},{key:"componentWillUnmount",value:function(){var e=this.state.chats;S=e,clearTimeout(O)}},{key:"render",value:function(){var e=this.state.chats,t=this.props,n=t.myId,a=t.pavId,i=this.props.openChat;return s.a.createElement(m.f,{id:"home",centered:n!==a},s.a.createElement(m.g,null,n===a?"\u0427\u0430\u0442\u0438\u043a\u0438":"\u0417\u0434\u0440\u0430\u0432\u0441\u0442\u0432\u0443\u0439\u0442\u0435!"),e.length>0?s.a.createElement(m.e,null,e.map(function(e,t){return s.a.createElement(m.a,{expandable:!0,onClick:function(){i(e.user_id)}},"\u0421\u043e\u0431\u0435\u0441\u0435\u0434\u043d\u0438\u043a #",t+1)})):s.a.createElement(m.c,{style:{textAlign:"center"}},"\u041f\u043e\u043a\u0430 \u043d\u0438\u043a\u0442\u043e \u043d\u0435 \u043d\u0430\u043f\u0438\u0441\u0430\u043b :("))}}]),t}(s.a.Component),A=function(e){function t(){return Object(l.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return s.a.createElement(m.f,{id:"loadingPanel",centered:!0},s.a.createElement(m.g,null,"\u0417\u0430\u0433\u0440\u0443\u0437\u043e\u0447\u043a\u0430..."),s.a.createElement(m.h,null))}}]),t}(s.a.Component),P=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];return(n=Object(d.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(s)))).state={history:[],activePanel:"loadingPanel",userId:null,myId:null,pavId:67602787},n.openChat=function(e){n.setState({userId:e}),n.go("chat")},n.go=function(e){var t=Object(o.a)(n.state.history);t.push(e),"home"===n.state.activePanel&&c.a.send("VKWebAppEnableSwipeBack"),n.setState({history:t,activePanel:e})},n.back=function(){var e=Object(o.a)(n.state.history);e.pop();var t=e[e.length-1];"home"===t&&c.a.send("VKWebAppDisableSwipeBack"),n.setState({history:e,activePanel:t})},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"setTheme",value:function(){var e=document.createAttribute("scheme");e.value="bright_light",document.body.attributes.setNamedItem(e)}},{key:"componentDidMount",value:function(){var e=this,t=this.state,n=(t.myId,t.pavId);t.openChat;this.setTheme(),c.a.send("VKWebAppGetUserInfo",{}).then(function(t){e.setState({myId:t.data.id}),t.data.id===n?e.go("home"):e.openChat(n)})}},{key:"render",value:function(){var e=this.state,t=e.myId,n=e.pavId,a=e.userId;return s.a.createElement(m.b,{isWebView:!0},s.a.createElement(m.i,{onSwipeBack:this.back,history:this.state.history,activePanel:this.state.activePanel},s.a.createElement(A,{id:"loadingPanel"}),s.a.createElement(x,{id:"home",myId:t,pavId:n,openChat:this.openChat}),s.a.createElement(w,{id:"chat",myId:t,pavId:n,back:this.back,userId:a})))}}]),t}(s.a.Component);c.a.send("VKWebAppInit",{}),r.a.render(s.a.createElement(P,null),document.getElementById("root"))}},[[166,1,2]]]);
//# sourceMappingURL=main.6229dca0.chunk.js.map